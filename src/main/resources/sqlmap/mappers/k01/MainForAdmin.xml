<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="k01.main.admin">

    <select id="selectYearTotInspectCnt" parameterType="HashMap" resultType="HashMap">
    <![CDATA[
     /* k01.main.inspector.selectYearTotInspectCnt - 전체도핑검사건수 ) */
    SELECT #{YEAR} AS CUR_YEAR
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) BEF_INSPECT
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=#{YEAR} THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) CURR_INSPECT
         , CASE WHEN SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) >0 THEN ROUND((SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=#{YEAR} THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) - SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ))/SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END )*100,2) ELSE 0 END RATE
         
         /*-------------분기*/
         --전년분기
         , nvl(sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ),0) as bef_bungi_1
         , nvl(sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ),0) as bef_bungi_2
         , nvl(sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ),0) as bef_bungi_3
         , nvl(sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ),0) as bef_bungi_4
         --현년분기
         , nvl(sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ),0) as cur_bungi_1
         , nvl(sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ),0) as cur_bungi_2
         , nvl(sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ),0) as cur_bungi_3
         , nvl(sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ),0) as cur_bungi_4
         /*-------------월
         --전년월*/
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='01'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='02'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='03'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='04'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='05'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='06'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='07'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='08'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='09'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='10'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='11'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='12'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_12
         /*--현년월*/
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '01'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '02'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '03'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '04'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '05'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '06'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '07'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '08'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '09'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '10'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '11'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '12'  THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_12
       FROM     (SELECT  T1.IPNT_DATE,T1.IPNT_EVENT_CODE AS EVENT_CODE
                ,SUM(T4.IPNT_PERIOD_I) + SUM(T4.IPNT_PERIOD_O) AS IPNT_PERIOD_TOT
                ,SUM(T4.IPNT_PERIOD_I) AS IPNT_PERIOD_I
                ,SUM(T4.IPNT_PERIOD_O) AS IPNT_PERIOD_O
                ,NVL((SELECT OPTION3 FROM CODE01TB WHERE MST_CODE = 'EVENT_CODE' AND DTL_CODE = T1.IPNT_EVENT_CODE),(SELECT CODE_NAME FROM CODE01TB WHERE MST_CODE = 'EVENT_CODE' AND DTL_CODE = T1.IPNT_EVENT_CODE)) AS EVENT_NAME
                ,SUM(T4.IPNT_FLAG_1) AS IPNT_FLAG_P
                ,SUM(T4.IPNT_FLAG_2) AS IPNT_FLAG_B
                ,SUM(T4.IPNT_FLAG_1) + SUM(T4.IPNT_FLAG_2) AS IPNT_FLAG_TOT
        FROM    IPNT01TB T1
                ,(
                SELECT  T.IPNT_UPPER_SEQ
                        ,MAX(CASE WHEN T.PREDECESSOR_YN = 'Y' THEN T.USER_NAME ELSE NULL END) AS PREDECESSOR_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_DCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS DCO_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_BCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS BCO_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_DCOBCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS DCOBCO_NAME
                        ,SUM(CASE WHEN T.CHOOSE_DCO_YN = 'Y' THEN 1 ELSE 0 END) AS DCO_COUNT
                        ,SUM(CASE WHEN T.CHOOSE_BCO_YN = 'Y' THEN 1 ELSE 0 END) AS BCO_COUNT
                        ,SUM(CASE WHEN T.CHOOSE_DCOBCO_YN = 'Y' THEN 1 ELSE 0 END) AS DCOBCO_COUNT
                        ,SUM(NVL(T.EXTRA_PAY, 0)) AS EXTRA_PAY
                        ,SUM(NVL(T.TRANSFER_PAY, 0)) + SUM(NVL(T.TRANSFER_ORG_PAY, 0)) + SUM(NVL(T.DAILY_PAY, 0)) + SUM(NVL(T.FOOD_PAY, 0)) + SUM(NVL(T.INN_PAY, 0)) + SUM(NVL(T.INN_ORG_PAY, 0)) AS ETC_PAY
                FROM    (
                        SELECT  B.IPNT_UPPER_SEQ
                                ,A.IPNT_NO
                                ,A.USER_ID
                                ,C.USER_NAME
                                ,A.CHOOSE_BCO_YN
                                ,A.CHOOSE_DCO_YN
                                ,A.CHOOSE_DCOBCO_YN
                                ,A.PREDECESSOR_YN
                                ,B.EXTRA_PAY
                                ,B.TRANSFER_PAY
                                ,B.TRANSFER_ORG_PAY
                                ,B.DAILY_PAY
                                ,B.FOOD_PAY
                                ,B.INN_PAY
                                ,B.INN_ORG_PAY
                                ,B.DISTANCE_DEFAULT_PAY
                        FROM    IPNT07TB A
                                ,IPCF02TB B
                                ,USER01TB C
                        WHERE   A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                        AND     A.USER_ID = B.USER_ID
                        AND     B.USER_ID = C.USER_ID
                        AND     A.USE_YN = 'Y'
                        ) T
                GROUP   BY T.IPNT_UPPER_SEQ
                ) T2
                ,IPDN01TB T3
                ,(
                SELECT  A.IPNT_UPPER_SEQ
                        ,SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_1
                        ,SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_2
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_I
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_O
                FROM    IPDN02TB A
                        ,IPNT01TB B
                WHERE    A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                AND      B.IPNT_TYPE = '1'
                GROUP   BY A.IPNT_UPPER_SEQ
                UNION ALL
                SELECT  A.IPNT_UPPER_SEQ
                        ,SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_1
                        ,SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_2
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_I
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_O
                FROM    IPDN02TB A
                        ,IPNT01TB B
                WHERE   A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                AND     B.IPNT_TYPE = '0'
                AND     (A.IPNT_ADDED IS NULL OR A.IPNT_ADDED <> 'Y')
                GROUP   BY A.IPNT_UPPER_SEQ
                ) T4
        WHERE   T1.IPNT_UPPER_SEQ = T2.IPNT_UPPER_SEQ
        AND     T1.IPNT_UPPER_SEQ = T3.IPNT_UPPER_SEQ
        AND     T1.IPNT_UPPER_SEQ = T4.IPNT_UPPER_SEQ
        AND     T3.PROCESS_STATUS = 'C'
        AND     T3.SUCCESS_STATUS = 'S'

        
AND     T1.IPNT_DATE BETWEEN (#{YEAR}-1)||'0101' AND #{YEAR}||'1231'

		AND     (SELECT OPTION1 FROM CODE01TB WHERE MST_CODE = 'IPNT_KIND_CODE' AND DTL_CODE = T1.IPNT_KIND_CODE) IN('Y','N','R','P')

		GROUP   BY  T1.IPNT_DATE ,T1.IPNT_EVENT_CODE)       
    ]]>               
    </select>
    
    <select id="selectPeriodIOTotInspectCnt" parameterType="HashMap" resultType="HashMap">
    <![CDATA[
     /* k01.main.inspector.selectPeriodIOTotInspectCnt - 검사구분별 검사구분건수 ) */
     SELECT #{YEAR}
         --년도
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) BEF_INSPECT
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) BEF_IPNT_PERIOD_I
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) BEF_IPNT_PERIOD_O
         
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=#{YEAR} THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) CURR_INSPECT
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=#{YEAR} THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) CURR_IPNT_PERIOD_I
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=#{YEAR} THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) CURR_IPNT_PERIOD_O
         -------------분기
         --전년분기
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_bungi_IPNT_PERIOD_I_1
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_bungi_IPNT_PERIOD_I_2
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_bungi_IPNT_PERIOD_I_3
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_bungi_IPNT_PERIOD_I_4
         
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_bungi_IPNT_PERIOD_O_1
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_bungi_IPNT_PERIOD_O_2
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_bungi_IPNT_PERIOD_O_3
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_bungi_IPNT_PERIOD_O_4
         
         --현년분기
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_bungi_IPNT_PERIOD_I_1
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_bungi_IPNT_PERIOD_I_2
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_bungi_IPNT_PERIOD_I_3
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_bungi_IPNT_PERIOD_I_4
         
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_bungi_IPNT_PERIOD_O_1
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_bungi_IPNT_PERIOD_O_2
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_bungi_IPNT_PERIOD_O_3
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_bungi_IPNT_PERIOD_O_4

         
         -------------월
         --전년월
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='01'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_IPNT_PERIOD_I_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='02'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_IPNT_PERIOD_I_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='03'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_IPNT_PERIOD_I_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='04'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_IPNT_PERIOD_I_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='05'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_IPNT_PERIOD_I_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='06'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_IPNT_PERIOD_I_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='07'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_IPNT_PERIOD_I_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='08'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_IPNT_PERIOD_I_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='09'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_IPNT_PERIOD_I_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='10'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_IPNT_PERIOD_I_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='11'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_IPNT_PERIOD_I_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='12'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as bef_IPNT_PERIOD_I_12
         
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='01'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_IPNT_PERIOD_O_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='02'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_IPNT_PERIOD_O_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='03'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_IPNT_PERIOD_O_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='04'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_IPNT_PERIOD_O_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='05'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_IPNT_PERIOD_O_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='06'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_IPNT_PERIOD_O_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='07'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_IPNT_PERIOD_O_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='08'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_IPNT_PERIOD_O_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='09'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_IPNT_PERIOD_O_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='10'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_IPNT_PERIOD_O_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='11'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_IPNT_PERIOD_O_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='12'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as bef_IPNT_PERIOD_O_12
         
         
         
         --현년월
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '01'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_IPNT_PERIOD_I_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '02'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_IPNT_PERIOD_I_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '03'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_IPNT_PERIOD_I_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '04'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_IPNT_PERIOD_I_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '05'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_IPNT_PERIOD_I_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '06'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_IPNT_PERIOD_I_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '07'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_IPNT_PERIOD_I_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '08'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_IPNT_PERIOD_I_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '09'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_IPNT_PERIOD_I_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '10'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_IPNT_PERIOD_I_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '11'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_IPNT_PERIOD_I_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '12'  THEN NVL(IPNT_PERIOD_I,0) ELSE 0 END ) as cur_IPNT_PERIOD_I_12
       
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '01'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_IPNT_PERIOD_O_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '02'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_IPNT_PERIOD_O_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '03'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_IPNT_PERIOD_O_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '04'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_IPNT_PERIOD_O_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '05'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_IPNT_PERIOD_O_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '06'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_IPNT_PERIOD_O_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '07'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_IPNT_PERIOD_O_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '08'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_IPNT_PERIOD_O_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '09'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_IPNT_PERIOD_O_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '10'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_IPNT_PERIOD_O_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '11'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_IPNT_PERIOD_O_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '12'  THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) as cur_IPNT_PERIOD_O_12
       
       FROM     (SELECT  T1.IPNT_DATE,T1.IPNT_EVENT_CODE AS EVENT_CODE
                ,SUM(T4.IPNT_PERIOD_I) + SUM(T4.IPNT_PERIOD_O) AS IPNT_PERIOD_TOT
                ,SUM(T4.IPNT_PERIOD_I) AS IPNT_PERIOD_I
                ,SUM(T4.IPNT_PERIOD_O) AS IPNT_PERIOD_O
                ,NVL((SELECT OPTION3 FROM CODE01TB WHERE MST_CODE = 'EVENT_CODE' AND DTL_CODE = T1.IPNT_EVENT_CODE),(SELECT CODE_NAME FROM CODE01TB WHERE MST_CODE = 'EVENT_CODE' AND DTL_CODE = T1.IPNT_EVENT_CODE)) AS EVENT_NAME
                ,SUM(T4.IPNT_FLAG_1) AS IPNT_FLAG_P
                ,SUM(T4.IPNT_FLAG_2) AS IPNT_FLAG_B
                ,SUM(T4.IPNT_FLAG_1) + SUM(T4.IPNT_FLAG_2) AS IPNT_FLAG_TOT
        FROM    IPNT01TB T1
                ,(
                SELECT  T.IPNT_UPPER_SEQ
                        ,MAX(CASE WHEN T.PREDECESSOR_YN = 'Y' THEN T.USER_NAME ELSE NULL END) AS PREDECESSOR_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_DCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS DCO_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_BCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS BCO_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_DCOBCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS DCOBCO_NAME
                        ,SUM(CASE WHEN T.CHOOSE_DCO_YN = 'Y' THEN 1 ELSE 0 END) AS DCO_COUNT
                        ,SUM(CASE WHEN T.CHOOSE_BCO_YN = 'Y' THEN 1 ELSE 0 END) AS BCO_COUNT
                        ,SUM(CASE WHEN T.CHOOSE_DCOBCO_YN = 'Y' THEN 1 ELSE 0 END) AS DCOBCO_COUNT
                        ,SUM(NVL(T.EXTRA_PAY, 0)) AS EXTRA_PAY
                        ,SUM(NVL(T.TRANSFER_PAY, 0)) + SUM(NVL(T.TRANSFER_ORG_PAY, 0)) + SUM(NVL(T.DAILY_PAY, 0)) + SUM(NVL(T.FOOD_PAY, 0)) + SUM(NVL(T.INN_PAY, 0)) + SUM(NVL(T.INN_ORG_PAY, 0)) AS ETC_PAY
                FROM    (
                        SELECT  B.IPNT_UPPER_SEQ
                                ,A.IPNT_NO
                                ,A.USER_ID
                                ,C.USER_NAME
                                ,A.CHOOSE_BCO_YN
                                ,A.CHOOSE_DCO_YN
                                ,A.CHOOSE_DCOBCO_YN
                                ,A.PREDECESSOR_YN
                                ,B.EXTRA_PAY
                                ,B.TRANSFER_PAY
                                ,B.TRANSFER_ORG_PAY
                                ,B.DAILY_PAY
                                ,B.FOOD_PAY
                                ,B.INN_PAY
                                ,B.INN_ORG_PAY
                                ,B.DISTANCE_DEFAULT_PAY
                        FROM    IPNT07TB A
                                ,IPCF02TB B
                                ,USER01TB C
                        WHERE   A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                        AND     A.USER_ID = B.USER_ID
                        AND     B.USER_ID = C.USER_ID
                        AND     A.USE_YN = 'Y'
                        ) T
                GROUP   BY T.IPNT_UPPER_SEQ
                ) T2
                ,IPDN01TB T3
                ,(
                SELECT  A.IPNT_UPPER_SEQ
                        ,SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_1
                        ,SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_2
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_I
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_O
                FROM    IPDN02TB A
                        ,IPNT01TB B
                WHERE    A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                AND      B.IPNT_TYPE = '1'
                GROUP   BY A.IPNT_UPPER_SEQ
                UNION ALL
                SELECT  A.IPNT_UPPER_SEQ
                        ,SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_1
                        ,SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_2
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_I
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_O
                FROM    IPDN02TB A
                        ,IPNT01TB B
                WHERE   A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                AND     B.IPNT_TYPE = '0'
                AND     (A.IPNT_ADDED IS NULL OR A.IPNT_ADDED <> 'Y')
                GROUP   BY A.IPNT_UPPER_SEQ
                ) T4
        WHERE   T1.IPNT_UPPER_SEQ = T2.IPNT_UPPER_SEQ
        AND     T1.IPNT_UPPER_SEQ = T3.IPNT_UPPER_SEQ
        AND     T1.IPNT_UPPER_SEQ = T4.IPNT_UPPER_SEQ
        AND     T3.PROCESS_STATUS = 'C'
        AND     T3.SUCCESS_STATUS = 'S'

        
AND     T1.IPNT_DATE BETWEEN (#{YEAR}-1)||'0101' AND #{YEAR}||'1231'

		AND     (SELECT OPTION1 FROM CODE01TB WHERE MST_CODE = 'IPNT_KIND_CODE' AND DTL_CODE = T1.IPNT_KIND_CODE) IN('Y','N','R','P')

		GROUP   BY  T1.IPNT_DATE ,T1.IPNT_EVENT_CODE)
     
     ]]>
     </select>
     
     <select id="selectFlagPBTotInspectCnt" parameterType="HashMap" resultType="HashMap">
    <![CDATA[
     /* k01.main.inspector.selectFlagPBTotInspectCnt - 시료유형별검사건수검사구분건수 ) */
     SELECT #{YEAR}
         --년도
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) BEF_INSPECT
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) BEF_IPNT_FLAG_P
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_O,0) ELSE 0 END ) BEF_IPNT_FLAG_B
         
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=#{YEAR} THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) CURR_INSPECT
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=#{YEAR} THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) CURR_IPNT_FLAG_P
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=#{YEAR} THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) CURR_IPNT_FLAG_B
         -------------분기
         --전년분기
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_bungi_IPNT_FLAG_P_1
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_bungi_IPNT_FLAG_P_2
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_bungi_IPNT_FLAG_P_3
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_bungi_IPNT_FLAG_P_4
         
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_bungi_IPNT_FLAG_B_1
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_bungi_IPNT_FLAG_B_2
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_bungi_IPNT_FLAG_B_3
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_bungi_IPNT_FLAG_B_4
         
         --현년분기
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_bungi_IPNT_FLAG_P_1
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_bungi_IPNT_FLAG_P_2
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_bungi_IPNT_FLAG_P_3
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_bungi_IPNT_FLAG_P_4
         
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_bungi_IPNT_FLAG_B_1
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_bungi_IPNT_FLAG_B_2
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_bungi_IPNT_FLAG_B_3
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_bungi_IPNT_FLAG_B_4

         
         -------------월
         --전년월
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='01'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_IPNT_FLAG_P_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='02'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_IPNT_FLAG_P_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='03'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_IPNT_FLAG_P_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='04'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_IPNT_FLAG_P_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='05'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_IPNT_FLAG_P_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='06'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_IPNT_FLAG_P_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='07'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_IPNT_FLAG_P_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='08'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_IPNT_FLAG_P_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='09'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_IPNT_FLAG_P_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='10'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_IPNT_FLAG_P_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='11'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_IPNT_FLAG_P_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='12'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as bef_IPNT_FLAG_P_12
         
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='01'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_IPNT_FLAG_B_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='02'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_IPNT_FLAG_B_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='03'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_IPNT_FLAG_B_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='04'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_IPNT_FLAG_B_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='05'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_IPNT_FLAG_B_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='06'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_IPNT_FLAG_B_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='07'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_IPNT_FLAG_B_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='08'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_IPNT_FLAG_B_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='09'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_IPNT_FLAG_B_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='10'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_IPNT_FLAG_B_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='11'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_IPNT_FLAG_B_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='12'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as bef_IPNT_FLAG_B_12
         
         
         
         --현년월
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '01'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_IPNT_FLAG_P_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '02'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_IPNT_FLAG_P_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '03'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_IPNT_FLAG_P_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '04'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_IPNT_FLAG_P_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '05'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_IPNT_FLAG_P_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '06'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_IPNT_FLAG_P_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '07'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_IPNT_FLAG_P_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '08'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_IPNT_FLAG_P_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '09'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_IPNT_FLAG_P_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '10'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_IPNT_FLAG_P_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '11'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_IPNT_FLAG_P_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '12'  THEN NVL(IPNT_FLAG_P,0) ELSE 0 END ) as cur_IPNT_FLAG_P_12
       
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '01'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_IPNT_FLAG_B_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '02'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_IPNT_FLAG_B_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '03'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_IPNT_FLAG_B_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '04'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_IPNT_FLAG_B_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '05'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_IPNT_FLAG_B_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '06'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_IPNT_FLAG_B_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '07'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_IPNT_FLAG_B_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '08'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_IPNT_FLAG_B_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '09'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_IPNT_FLAG_B_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '10'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_IPNT_FLAG_B_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '11'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_IPNT_FLAG_B_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '12'  THEN NVL(IPNT_FLAG_B,0) ELSE 0 END ) as cur_IPNT_FLAG_B_12
       
       FROM     (SELECT  T1.IPNT_DATE,T1.IPNT_EVENT_CODE AS EVENT_CODE
                ,SUM(T4.IPNT_PERIOD_I) + SUM(T4.IPNT_PERIOD_O) AS IPNT_PERIOD_TOT
                ,SUM(T4.IPNT_PERIOD_I) AS IPNT_PERIOD_I
                ,SUM(T4.IPNT_PERIOD_O) AS IPNT_PERIOD_O
                ,NVL((SELECT OPTION3 FROM CODE01TB WHERE MST_CODE = 'EVENT_CODE' AND DTL_CODE = T1.IPNT_EVENT_CODE),(SELECT CODE_NAME FROM CODE01TB WHERE MST_CODE = 'EVENT_CODE' AND DTL_CODE = T1.IPNT_EVENT_CODE)) AS EVENT_NAME
                ,SUM(T4.IPNT_FLAG_1) AS IPNT_FLAG_P
                ,SUM(T4.IPNT_FLAG_2) AS IPNT_FLAG_B
                ,SUM(T4.IPNT_FLAG_1) + SUM(T4.IPNT_FLAG_2) AS IPNT_FLAG_TOT
        FROM    IPNT01TB T1
                ,(
                SELECT  T.IPNT_UPPER_SEQ
                        ,MAX(CASE WHEN T.PREDECESSOR_YN = 'Y' THEN T.USER_NAME ELSE NULL END) AS PREDECESSOR_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_DCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS DCO_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_BCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS BCO_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_DCOBCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS DCOBCO_NAME
                        ,SUM(CASE WHEN T.CHOOSE_DCO_YN = 'Y' THEN 1 ELSE 0 END) AS DCO_COUNT
                        ,SUM(CASE WHEN T.CHOOSE_BCO_YN = 'Y' THEN 1 ELSE 0 END) AS BCO_COUNT
                        ,SUM(CASE WHEN T.CHOOSE_DCOBCO_YN = 'Y' THEN 1 ELSE 0 END) AS DCOBCO_COUNT
                        ,SUM(NVL(T.EXTRA_PAY, 0)) AS EXTRA_PAY
                        ,SUM(NVL(T.TRANSFER_PAY, 0)) + SUM(NVL(T.TRANSFER_ORG_PAY, 0)) + SUM(NVL(T.DAILY_PAY, 0)) + SUM(NVL(T.FOOD_PAY, 0)) + SUM(NVL(T.INN_PAY, 0)) + SUM(NVL(T.INN_ORG_PAY, 0)) AS ETC_PAY
                FROM    (
                        SELECT  B.IPNT_UPPER_SEQ
                                ,A.IPNT_NO
                                ,A.USER_ID
                                ,C.USER_NAME
                                ,A.CHOOSE_BCO_YN
                                ,A.CHOOSE_DCO_YN
                                ,A.CHOOSE_DCOBCO_YN
                                ,A.PREDECESSOR_YN
                                ,B.EXTRA_PAY
                                ,B.TRANSFER_PAY
                                ,B.TRANSFER_ORG_PAY
                                ,B.DAILY_PAY
                                ,B.FOOD_PAY
                                ,B.INN_PAY
                                ,B.INN_ORG_PAY
                                ,B.DISTANCE_DEFAULT_PAY
                        FROM    IPNT07TB A
                                ,IPCF02TB B
                                ,USER01TB C
                        WHERE   A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                        AND     A.USER_ID = B.USER_ID
                        AND     B.USER_ID = C.USER_ID
                        AND     A.USE_YN = 'Y'
                        ) T
                GROUP   BY T.IPNT_UPPER_SEQ
                ) T2
                ,IPDN01TB T3
                ,(
                SELECT  A.IPNT_UPPER_SEQ
                        ,SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_1
                        ,SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_2
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_I
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_O
                FROM    IPDN02TB A
                        ,IPNT01TB B
                WHERE    A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                AND      B.IPNT_TYPE = '1'
                GROUP   BY A.IPNT_UPPER_SEQ
                UNION ALL
                SELECT  A.IPNT_UPPER_SEQ
                        ,SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_1
                        ,SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_2
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_I
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_O
                FROM    IPDN02TB A
                        ,IPNT01TB B
                WHERE   A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                AND     B.IPNT_TYPE = '0'
                AND     (A.IPNT_ADDED IS NULL OR A.IPNT_ADDED <> 'Y')
                GROUP   BY A.IPNT_UPPER_SEQ
                ) T4
        WHERE   T1.IPNT_UPPER_SEQ = T2.IPNT_UPPER_SEQ
        AND     T1.IPNT_UPPER_SEQ = T3.IPNT_UPPER_SEQ
        AND     T1.IPNT_UPPER_SEQ = T4.IPNT_UPPER_SEQ
        AND     T3.PROCESS_STATUS = 'C'
        AND     T3.SUCCESS_STATUS = 'S'

        
AND     T1.IPNT_DATE BETWEEN (#{YEAR}-1)||'0101' AND #{YEAR}||'1231'

		AND     (SELECT OPTION1 FROM CODE01TB WHERE MST_CODE = 'IPNT_KIND_CODE' AND DTL_CODE = T1.IPNT_KIND_CODE) IN('Y','N','R','P')

		GROUP   BY  T1.IPNT_DATE ,T1.IPNT_EVENT_CODE)
     
     ]]>
     </select>
     
     <select id="selectipntTypeTotInspectCnt" parameterType="HashMap" resultType="HashMap">
    <![CDATA[
    /* k01.main.inspector.selectipntTypeTotInspectCnt - 검사재원별 검사건수조회 ) */
     SELECT #{YEAR}
         --년도
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) BEF_INSPECT
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) BEF_IPNT_TYPE_0  --기금
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) BEF_IPNT_TYPE_1  --요청
                  
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=#{YEAR} THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) CURR_INSPECT
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) BEF_IPNT_TYPE_0 --기금
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) BEF_IPNT_TYPE_1 --요청
         -------------분기
         --전년분기
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_bungi_IPNT_FLAG_P_1
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_bungi_IPNT_FLAG_P_2
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_bungi_IPNT_FLAG_P_3
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_bungi_IPNT_FLAG_P_4
         
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_bungi_IPNT_FLAG_B_1
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_bungi_IPNT_FLAG_B_2
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_bungi_IPNT_FLAG_B_3
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_bungi_IPNT_FLAG_B_4
         
         --현년분기
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_bungi_IPNT_FLAG_P_1
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_bungi_IPNT_FLAG_P_2
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_bungi_IPNT_FLAG_P_3
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_bungi_IPNT_FLAG_P_4
         
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('01','02','03')  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_bungi_IPNT_FLAG_B_1
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('04','04','06')  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_bungi_IPNT_FLAG_B_2
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('07','08','09')  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_bungi_IPNT_FLAG_B_3
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) in('10','11','12')  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_bungi_IPNT_FLAG_B_4

         
         -------------월
         --전년월
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='01'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_IPNT_FLAG_P_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='02'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_IPNT_FLAG_P_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='03'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_IPNT_FLAG_P_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='04'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_IPNT_FLAG_P_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='05'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_IPNT_FLAG_P_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='06'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_IPNT_FLAG_P_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='07'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_IPNT_FLAG_P_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='08'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_IPNT_FLAG_P_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='09'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_IPNT_FLAG_P_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='10'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_IPNT_FLAG_P_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='11'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_IPNT_FLAG_P_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='12'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as bef_IPNT_FLAG_P_12
         
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='01'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_IPNT_FLAG_B_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='02'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_IPNT_FLAG_B_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='03'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_IPNT_FLAG_B_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='04'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_IPNT_FLAG_B_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='05'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_IPNT_FLAG_B_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='06'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_IPNT_FLAG_B_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='07'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_IPNT_FLAG_B_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='08'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_IPNT_FLAG_B_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='09'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_IPNT_FLAG_B_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='10'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_IPNT_FLAG_B_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='11'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_IPNT_FLAG_B_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) and SUBSTR(IPNT_DATE,5,2) ='12'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as bef_IPNT_FLAG_B_12
         
         
         
         --현년월
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '01'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_IPNT_FLAG_P_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '02'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_IPNT_FLAG_P_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '03'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_IPNT_FLAG_P_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '04'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_IPNT_FLAG_P_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '05'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_IPNT_FLAG_P_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '06'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_IPNT_FLAG_P_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '07'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_IPNT_FLAG_P_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '08'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_IPNT_FLAG_P_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '09'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_IPNT_FLAG_P_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '10'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_IPNT_FLAG_P_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '11'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_IPNT_FLAG_P_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '12'  AND IPNT_TYPE='0' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END  ) as cur_IPNT_FLAG_P_12
       
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '01'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_IPNT_FLAG_B_01
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '02'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_IPNT_FLAG_B_02
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '03'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_IPNT_FLAG_B_03
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '04'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_IPNT_FLAG_B_04
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '05'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_IPNT_FLAG_B_05
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '06'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_IPNT_FLAG_B_06
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '07'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_IPNT_FLAG_B_07
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '08'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_IPNT_FLAG_B_08
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '09'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_IPNT_FLAG_B_09
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '10'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_IPNT_FLAG_B_10
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '11'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_IPNT_FLAG_B_11
         , sum(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}) and SUBSTR(IPNT_DATE,5,2) = '12'  AND IPNT_TYPE='1' THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) as cur_IPNT_FLAG_B_12
        
        
        
       FROM     (SELECT  T1.IPNT_DATE,T1.IPNT_EVENT_CODE AS EVENT_CODE
                , T1.IPNT_TYPE
                ,SUM(T4.IPNT_PERIOD_I) + SUM(T4.IPNT_PERIOD_O) AS IPNT_PERIOD_TOT
                ,SUM(T4.IPNT_PERIOD_I) AS IPNT_PERIOD_I
                ,SUM(T4.IPNT_PERIOD_O) AS IPNT_PERIOD_O
                ,NVL((SELECT OPTION3 FROM CODE01TB WHERE MST_CODE = 'EVENT_CODE' AND DTL_CODE = T1.IPNT_EVENT_CODE),(SELECT CODE_NAME FROM CODE01TB WHERE MST_CODE = 'EVENT_CODE' AND DTL_CODE = T1.IPNT_EVENT_CODE)) AS EVENT_NAME
                ,SUM(T4.IPNT_FLAG_1) AS IPNT_FLAG_P
                ,SUM(T4.IPNT_FLAG_2) AS IPNT_FLAG_B
                ,SUM(T4.IPNT_FLAG_1) + SUM(T4.IPNT_FLAG_2) AS IPNT_FLAG_TOT
        FROM    IPNT01TB T1
                ,(
                SELECT  T.IPNT_UPPER_SEQ
                        ,MAX(CASE WHEN T.PREDECESSOR_YN = 'Y' THEN T.USER_NAME ELSE NULL END) AS PREDECESSOR_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_DCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS DCO_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_BCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS BCO_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_DCOBCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS DCOBCO_NAME
                        ,SUM(CASE WHEN T.CHOOSE_DCO_YN = 'Y' THEN 1 ELSE 0 END) AS DCO_COUNT
                        ,SUM(CASE WHEN T.CHOOSE_BCO_YN = 'Y' THEN 1 ELSE 0 END) AS BCO_COUNT
                        ,SUM(CASE WHEN T.CHOOSE_DCOBCO_YN = 'Y' THEN 1 ELSE 0 END) AS DCOBCO_COUNT
                        ,SUM(NVL(T.EXTRA_PAY, 0)) AS EXTRA_PAY
                        ,SUM(NVL(T.TRANSFER_PAY, 0)) + SUM(NVL(T.TRANSFER_ORG_PAY, 0)) + SUM(NVL(T.DAILY_PAY, 0)) + SUM(NVL(T.FOOD_PAY, 0)) + SUM(NVL(T.INN_PAY, 0)) + SUM(NVL(T.INN_ORG_PAY, 0)) AS ETC_PAY
                FROM    (
                        SELECT  B.IPNT_UPPER_SEQ
                                ,A.IPNT_NO
                                ,A.USER_ID
                                ,C.USER_NAME
                                ,A.CHOOSE_BCO_YN
                                ,A.CHOOSE_DCO_YN
                                ,A.CHOOSE_DCOBCO_YN
                                ,A.PREDECESSOR_YN
                                ,B.EXTRA_PAY
                                ,B.TRANSFER_PAY
                                ,B.TRANSFER_ORG_PAY
                                ,B.DAILY_PAY
                                ,B.FOOD_PAY
                                ,B.INN_PAY
                                ,B.INN_ORG_PAY
                                ,B.DISTANCE_DEFAULT_PAY
                        FROM    IPNT07TB A
                                ,IPCF02TB B
                                ,USER01TB C
                        WHERE   A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                        AND     A.USER_ID = B.USER_ID
                        AND     B.USER_ID = C.USER_ID
                        AND     A.USE_YN = 'Y'
                        ) T
                GROUP   BY T.IPNT_UPPER_SEQ
                ) T2
                ,IPDN01TB T3
                ,(
                SELECT  A.IPNT_UPPER_SEQ
                        ,SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_1
                        ,SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_2
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_I
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_O
                FROM    IPDN02TB A
                        ,IPNT01TB B
                WHERE    A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                AND      B.IPNT_TYPE = '1'
                GROUP   BY A.IPNT_UPPER_SEQ
                UNION ALL
                SELECT  A.IPNT_UPPER_SEQ
                        ,SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_1
                        ,SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_2
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_I
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_O
                FROM    IPDN02TB A
                        ,IPNT01TB B
                WHERE   A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                AND     B.IPNT_TYPE = '0'
                AND     (A.IPNT_ADDED IS NULL OR A.IPNT_ADDED <> 'Y')
                GROUP   BY A.IPNT_UPPER_SEQ
                ) T4
        WHERE   T1.IPNT_UPPER_SEQ = T2.IPNT_UPPER_SEQ
        AND     T1.IPNT_UPPER_SEQ = T3.IPNT_UPPER_SEQ
        AND     T1.IPNT_UPPER_SEQ = T4.IPNT_UPPER_SEQ
        AND     T3.PROCESS_STATUS = 'C'
        AND     T3.SUCCESS_STATUS = 'S'

        
AND     T1.IPNT_DATE BETWEEN (#{YEAR}-1)||'0101' AND #{YEAR}||'1231'

		AND     (SELECT OPTION1 FROM CODE01TB WHERE MST_CODE = 'IPNT_KIND_CODE' AND DTL_CODE = T1.IPNT_KIND_CODE) IN('Y','N','R','P')

		GROUP   BY  T1.IPNT_DATE ,T1.IPNT_EVENT_CODE,T1.IPNT_TYPE)
    
    ]]>
    </select>
    
    <select id="selectPeriodTotInspectCnt" parameterType="HashMap" resultType="HashMap">
    <![CDATA[
    /* k01.main.inspector.selectPeriodTotInspectCnt - 분석별 검사건수 조회 ) */
    SELECT INX01_CODE
     , INX01_NAME
     , INX01_CNT
     , INX02_CODE
     , INX02_NAME
     , INX02_CNT
     , INX03_CODE
     , INX03_NAME
     , INX03_CNT
     , INX04_CODE
     , INX04_NAME
     , INX04_CNT
     , INX05_CODE
     , INX05_NAME
     , INX05_CNT
     , INX06_CODE
     , INX06_NAME
     , INX06_CNT
     , INX07_CODE
     , INX07_NAME
     , INX07_CNT
     , INX08_CODE
     , INX08_NAME
     , INX08_CNT
     , INX09_CODE
     , INX09_NAME
     , INX09_CNT
     , INX10_CODE
     , INX10_NAME
     , INX10_CNT
     , INX11_CODE
     , INX11_NAME
     , INX11_CNT
     , INX12_CODE
     , INX12_NAME
     , INX12_CNT
     , INX13_CODE
     , INX13_NAME
     , INX13_CNT
     , INX14_CODE
     , INX14_NAME
     , INX14_CNT     
FROM (SELECT DTL_CODE, CODE_NAME, CODE_NAME AS NAME, NVL(CURR_INSPECT,0) AS CURR_INSPECT
FROM (SELECT
    T1.MST_CODE,
    T1.DTL_CODE,
    T1.CODE_NAME,
    T1.SORT_ORDER,
    T1.USE_YN,
    T1.OPTION1,
    T1.OPTION2,
    T1.OPTION3,
    T1.OPTION4,
    T1.OPTION5,
    T1.MEMO,
    T1.REG_USER,
    T1.EDT_USER
FROM
    CODE01TB T1
WHERE
    T1.USE_YN = 'Y'
    AND T1.MST_CODE = 'IPNT_SUB_FLAG') A
    LEFT OUTER JOIN (
SELECT #{YEAR} AS YEAR
         --년도
         , IPNT_SUB_FLAG
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) BEF_INSPECT
                  
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=#{YEAR} THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) CURR_INSPECT
         -------------분기
         
        
       FROM     (SELECT  T1.IPNT_DATE,T1.IPNT_EVENT_CODE AS EVENT_CODE
                , T4.IPNT_SUB_FLAG
                ,SUM(T4.IPNT_PERIOD_I) + SUM(T4.IPNT_PERIOD_O) AS IPNT_PERIOD_TOT
                ,SUM(T4.IPNT_PERIOD_I) AS IPNT_PERIOD_I
                ,SUM(T4.IPNT_PERIOD_O) AS IPNT_PERIOD_O
                ,NVL((SELECT OPTION3 FROM CODE01TB WHERE MST_CODE = 'EVENT_CODE' AND DTL_CODE = T1.IPNT_EVENT_CODE),(SELECT CODE_NAME FROM CODE01TB WHERE MST_CODE = 'EVENT_CODE' AND DTL_CODE = T1.IPNT_EVENT_CODE)) AS EVENT_NAME
                ,SUM(T4.IPNT_FLAG_1) AS IPNT_FLAG_P
                ,SUM(T4.IPNT_FLAG_2) AS IPNT_FLAG_B
                ,SUM(T4.IPNT_FLAG_1) + SUM(T4.IPNT_FLAG_2) AS IPNT_FLAG_TOT
        FROM    IPNT01TB T1
                ,(
                SELECT  T.IPNT_UPPER_SEQ
                        ,MAX(CASE WHEN T.PREDECESSOR_YN = 'Y' THEN T.USER_NAME ELSE NULL END) AS PREDECESSOR_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_DCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS DCO_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_BCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS BCO_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_DCOBCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS DCOBCO_NAME
                        ,SUM(CASE WHEN T.CHOOSE_DCO_YN = 'Y' THEN 1 ELSE 0 END) AS DCO_COUNT
                        ,SUM(CASE WHEN T.CHOOSE_BCO_YN = 'Y' THEN 1 ELSE 0 END) AS BCO_COUNT
                        ,SUM(CASE WHEN T.CHOOSE_DCOBCO_YN = 'Y' THEN 1 ELSE 0 END) AS DCOBCO_COUNT
                        ,SUM(NVL(T.EXTRA_PAY, 0)) AS EXTRA_PAY
                        ,SUM(NVL(T.TRANSFER_PAY, 0)) + SUM(NVL(T.TRANSFER_ORG_PAY, 0)) + SUM(NVL(T.DAILY_PAY, 0)) + SUM(NVL(T.FOOD_PAY, 0)) + SUM(NVL(T.INN_PAY, 0)) + SUM(NVL(T.INN_ORG_PAY, 0)) AS ETC_PAY
                FROM    (
                        SELECT  B.IPNT_UPPER_SEQ
                                ,A.IPNT_NO
                                ,A.USER_ID
                                ,C.USER_NAME
                                ,A.CHOOSE_BCO_YN
                                ,A.CHOOSE_DCO_YN
                                ,A.CHOOSE_DCOBCO_YN
                                ,A.PREDECESSOR_YN
                                ,B.EXTRA_PAY
                                ,B.TRANSFER_PAY
                                ,B.TRANSFER_ORG_PAY
                                ,B.DAILY_PAY
                                ,B.FOOD_PAY
                                ,B.INN_PAY
                                ,B.INN_ORG_PAY
                                ,B.DISTANCE_DEFAULT_PAY
                        FROM    IPNT07TB A
                                ,IPCF02TB B
                                ,USER01TB C
                        WHERE   A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                        AND     A.USER_ID = B.USER_ID
                        AND     B.USER_ID = C.USER_ID
                        AND     A.USE_YN = 'Y'
                        ) T
                GROUP   BY T.IPNT_UPPER_SEQ
                ) T2
                ,IPDN01TB T3
                ,(
                SELECT  A.IPNT_UPPER_SEQ
                        , A.IPNT_SUB_FLAG
                        ,SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_1
                        ,SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_2
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_I
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_O
                FROM    IPDN02TB A
                        ,IPNT01TB B
                WHERE    A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                AND      B.IPNT_TYPE = '1'
                GROUP   BY A.IPNT_UPPER_SEQ, A.IPNT_SUB_FLAG
                UNION ALL
                SELECT  A.IPNT_UPPER_SEQ
                        , A.IPNT_SUB_FLAG
                        ,SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_1
                        ,SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_2
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_I
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_O
                FROM    IPDN02TB A
                        ,IPNT01TB B
                WHERE   A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                AND     B.IPNT_TYPE = '0'
                AND     (A.IPNT_ADDED IS NULL OR A.IPNT_ADDED <> 'Y')
                GROUP   BY A.IPNT_UPPER_SEQ, A.IPNT_SUB_FLAG
                ) T4
        WHERE   T1.IPNT_UPPER_SEQ = T2.IPNT_UPPER_SEQ
        AND     T1.IPNT_UPPER_SEQ = T3.IPNT_UPPER_SEQ
        AND     T1.IPNT_UPPER_SEQ = T4.IPNT_UPPER_SEQ
        AND     T3.PROCESS_STATUS = 'C'
        AND     T3.SUCCESS_STATUS = 'S'

        
AND     T1.IPNT_DATE BETWEEN (#{YEAR}-1)||'0101' AND #{YEAR}||'1231'

		AND     (SELECT OPTION1 FROM CODE01TB WHERE MST_CODE = 'IPNT_KIND_CODE' AND DTL_CODE = T1.IPNT_KIND_CODE) IN('Y','N','R','P')

		GROUP   BY  T1.IPNT_DATE ,T1.IPNT_EVENT_CODE,T4.IPNT_SUB_FLAG)
		GROUP BY IPNT_SUB_FLAG
		) B 
		ON B.IPNT_SUB_FLAG =A.DTL_CODE
	ORDER BY A.OPTION1, A.SORT_ORDER)
PIVOT ( MAX(DTL_CODE) AS CODE,MAX(NAME) AS NAME,SUM(CURR_INSPECT)  AS CNT  
                      FOR CODE_NAME IN( '일반'            AS INX01 
                                       ,'일반+ESAs'       AS INX02 
                                       ,'일반+GHRFs'      AS INX03
                                       ,'IRMS'            AS INX04
                                       ,'일반+ESAs+GHRFs' AS INX05
                                       ,'기타(소변)'      AS INX06
                                       ,'ABP'             AS INX07
                                       ,'hGH(I)'          AS INX08
                                       ,'hGH(B)'          AS INX09
                                       ,'ESA'             AS INX10
                                       ,'BT'              AS INX11
                                       ,'기타(혈액)'      AS INX12
                                       ,'-'               AS INX13
                                       ,'기타(호흡)'      AS INX14) 
                                       )
    ]]>
    </select>
    
    <select id="selectLocationInspectCnt" parameterType="HashMap" resultType="HashMap">
    <![CDATA[
    /* k01.main.inspector.selectLocationInspectCnt - 지역별 검사건수 조회 ) */
    
    
    SELECT #{YEAR}
           ,SI_DO
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) BEF_INSPECT
         , SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=#{YEAR} THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) CURR_INSPECT
         , CASE WHEN SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) >0 THEN ROUND((SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=#{YEAR} THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ) - SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END ))/SUM(CASE WHEN SUBSTR(IPNT_DATE,1,4)=(#{YEAR}-1) THEN NVL(IPNT_PERIOD_TOT,0) ELSE 0 END )*100,2) ELSE 0 END RATE
     
         
       FROM     (SELECT  T1.IPNT_DATE,T1.IPNT_EVENT_CODE AS EVENT_CODE
                , T4.SI_DO
                ,SUM(T4.IPNT_PERIOD_I) + SUM(T4.IPNT_PERIOD_O) AS IPNT_PERIOD_TOT
                ,SUM(T4.IPNT_PERIOD_I) AS IPNT_PERIOD_I
                ,SUM(T4.IPNT_PERIOD_O) AS IPNT_PERIOD_O
                ,NVL((SELECT OPTION3 FROM CODE01TB WHERE MST_CODE = 'EVENT_CODE' AND DTL_CODE = T1.IPNT_EVENT_CODE),(SELECT CODE_NAME FROM CODE01TB WHERE MST_CODE = 'EVENT_CODE' AND DTL_CODE = T1.IPNT_EVENT_CODE)) AS EVENT_NAME
                ,SUM(T4.IPNT_FLAG_1) AS IPNT_FLAG_P
                ,SUM(T4.IPNT_FLAG_2) AS IPNT_FLAG_B
                ,SUM(T4.IPNT_FLAG_1) + SUM(T4.IPNT_FLAG_2) AS IPNT_FLAG_TOT
        FROM    IPNT01TB T1
                ,(
                SELECT  T.IPNT_UPPER_SEQ
                        ,MAX(CASE WHEN T.PREDECESSOR_YN = 'Y' THEN T.USER_NAME ELSE NULL END) AS PREDECESSOR_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_DCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS DCO_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_BCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS BCO_NAME
                        ,TO_CHAR(WM_CONCAT(CASE WHEN T.CHOOSE_DCOBCO_YN = 'Y' AND T.PREDECESSOR_YN <> 'Y' THEN T.USER_NAME ELSE NULL END)) AS DCOBCO_NAME
                        ,SUM(CASE WHEN T.CHOOSE_DCO_YN = 'Y' THEN 1 ELSE 0 END) AS DCO_COUNT
                        ,SUM(CASE WHEN T.CHOOSE_BCO_YN = 'Y' THEN 1 ELSE 0 END) AS BCO_COUNT
                        ,SUM(CASE WHEN T.CHOOSE_DCOBCO_YN = 'Y' THEN 1 ELSE 0 END) AS DCOBCO_COUNT
                        ,SUM(NVL(T.EXTRA_PAY, 0)) AS EXTRA_PAY
                        ,SUM(NVL(T.TRANSFER_PAY, 0)) + SUM(NVL(T.TRANSFER_ORG_PAY, 0)) + SUM(NVL(T.DAILY_PAY, 0)) + SUM(NVL(T.FOOD_PAY, 0)) + SUM(NVL(T.INN_PAY, 0)) + SUM(NVL(T.INN_ORG_PAY, 0)) AS ETC_PAY
                FROM    (
                        SELECT  B.IPNT_UPPER_SEQ
                                ,A.IPNT_NO
                                ,A.USER_ID
                                ,C.USER_NAME
                                ,A.CHOOSE_BCO_YN
                                ,A.CHOOSE_DCO_YN
                                ,A.CHOOSE_DCOBCO_YN
                                ,A.PREDECESSOR_YN
                                ,B.EXTRA_PAY
                                ,B.TRANSFER_PAY
                                ,B.TRANSFER_ORG_PAY
                                ,B.DAILY_PAY
                                ,B.FOOD_PAY
                                ,B.INN_PAY
                                ,B.INN_ORG_PAY
                                ,B.DISTANCE_DEFAULT_PAY
                        FROM    IPNT07TB A
                                ,IPCF02TB B
                                ,USER01TB C
                        WHERE   A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                        AND     A.USER_ID = B.USER_ID
                        AND     B.USER_ID = C.USER_ID
                        AND     A.USE_YN = 'Y'
                        ) T
                GROUP   BY T.IPNT_UPPER_SEQ
                ) T2
                ,IPDN01TB T3
                ,(
                SELECT  A.IPNT_UPPER_SEQ
, CASE WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '서울%' THEN '서울특별시' 
        WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '경기%' THEN '경기도'
        WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '강원%' THEN '강원도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '충남%' THEN '충청남도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '충북%' THEN '충청북도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '경남%' THEN '경상남도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '경북%' THEN '경상북도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '전남%' THEN '전라남도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '전북%' THEN '전라북도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '제주%' THEN '제주특별자치도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '부산%' THEN '부산광역시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '광주%' THEN '광주광역시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '대전%' THEN '광주광역시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '대구%' THEN '대구광역시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '울산%' THEN '울산광역시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '인천%' THEN '인천광역시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '세종%' THEN '세종특별자치시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) IS NULL THEN '알수없음'
       ELSE SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1)
END as si_do
                        ,SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_1
                        ,SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_2
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_I
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_O
                FROM    IPDN02TB A
                        ,IPNT01TB B
                WHERE    A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                AND      B.IPNT_TYPE = '1'
                GROUP   BY A.IPNT_UPPER_SEQ,SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1)
                UNION ALL
                SELECT  A.IPNT_UPPER_SEQ
                , CASE WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '서울%' THEN '서울특별시' 
        WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '경기%' THEN '경기도'
        WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '강원%' THEN '강원도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '충남%' THEN '충청남도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '충북%' THEN '충청북도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '경남%' THEN '경상남도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '경북%' THEN '경상북도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '전남%' THEN '전라남도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '전북%' THEN '전라북도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '제주%' THEN '제주특별자치도'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '부산%' THEN '부산광역시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '광주%' THEN '광주광역시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '대전%' THEN '광주광역시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '대구%' THEN '대구광역시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '울산%' THEN '울산광역시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '인천%' THEN '인천광역시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) LIKE '세종%' THEN '세종특별자치시'
       WHEN SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1) IS NULL THEN '알수없음'
       ELSE SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1)
END as si_do
                        ,SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_1
                        ,SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_FLAG_2
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '0' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_I
                        ,SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND  A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('11', '12', '13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('12', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG IN ('13', '15') THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_SUB_FLAG = '14' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY, 0) ELSE 0 END)
                        +SUM(CASE WHEN B.IPNT_PERIOD_CODE = '1' AND A.IPNT_FLAG = '2' THEN NVL(A.IPNT_FLAG_QTY_F, 0) ELSE 0 END) AS IPNT_PERIOD_O
                FROM    IPDN02TB A
                        ,IPNT01TB B
                WHERE   A.IPNT_UPPER_SEQ = B.IPNT_UPPER_SEQ
                AND     B.IPNT_TYPE = '0'
                AND     (A.IPNT_ADDED IS NULL OR A.IPNT_ADDED <> 'Y')
                GROUP   BY A.IPNT_UPPER_SEQ,SUBSTR(B.IPNT_PLACE_ADDRESS,1, INSTR(B.IPNT_PLACE_ADDRESS, ' ',1,1)-1)
                ) T4
        WHERE   T1.IPNT_UPPER_SEQ = T2.IPNT_UPPER_SEQ
        AND     T1.IPNT_UPPER_SEQ = T3.IPNT_UPPER_SEQ
        AND     T1.IPNT_UPPER_SEQ = T4.IPNT_UPPER_SEQ
        AND     T3.PROCESS_STATUS = 'C'
        AND     T3.SUCCESS_STATUS = 'S'

        
AND     T1.IPNT_DATE BETWEEN (#{YEAR}-1)||'0101' AND #{YEAR}||'1231'

		AND     (SELECT OPTION1 FROM CODE01TB WHERE MST_CODE = 'IPNT_KIND_CODE' AND DTL_CODE = T1.IPNT_KIND_CODE) IN('Y','N','R','P')

		GROUP   BY  T1.IPNT_DATE ,T1.IPNT_EVENT_CODE, SI_DO)
		GROUP BY SI_DO   
		ORDER BY SI_DO
		]]>
    </select>
    
    <select id="selectDcoAllCnt" parameterType="HashMap" resultType="HashMap">
    <![CDATA[
    /* k01.main.inspector.selectDcoAllCnt - DCO현황전체인원 조회 ) */
    SELECT COUNT(*) AS ALL_CNT
         , SUM( CASE WHEN DCO_YN ='Y' AND BCO_YN='N' THEN 1 ELSE 0 END ) AS DCO_CNT
         , SUM( CASE WHEN DCO_YN ='N' AND BCO_YN='Y' THEN 1 ELSE 0 END ) AS BCO_CNT
         , SUM( CASE WHEN DCO_YN ='Y' AND BCO_YN='Y' THEN 1 ELSE 0 END ) AS DCOBCO_CNT
      FROM USER01TB  A
     WHERE 1=1 
       AND (DCO_YN ='Y' OR BCO_YN='Y' OR INSPECTOR_POOL IS NOT NULL) 
       AND ( AUTH_ID NOT IN('TEST2','TEST3','ubi1','ZZZ','77777','1234') OR AUTH_ID NOT LIKE 'E%')
    ]]>
    </select>
    
    <select id="selectDcoInspectPoolcnt" parameterType="HashMap" resultType="HashMap">
    <![CDATA[
    /* k01.main.inspector.selectDcoInspectPoolcnt - DCO 선임 pool 조회 ) */
    
    SELECT NVL(INX1_CODENM,'알수없음1') AS INX1_CODENM
         , NVL(INX1_POOL_CNT,0) AS INX1_POOL_CNT
         , NVL(INX2_CODENM,'알수없음2') AS INX2_CODENM
         , NVL(INX2_POOL_CNT,0) AS INX2_POOL_CNT
         , NVL(INX3_CODENM,'알수없음3') AS INX3_CODENM
         , NVL(INX3_POOL_CNT,0) AS INX3_POOL_CNT
         , NVL(INX4_CODENM,'알수없음4') AS INX4_CODENM
         , NVL(INX4_POOL_CNT,0) AS INX4_POOL_CNT
	  FROM (
		       SELECT NAME
		            , POOL_CNT
		            , CDNAME 
		         FROM (
				         SELECT NVL(INSPECTOR_POOL,0) AS INSPECTOR_POOL
			    	          , DECODE(B.CODE_NAME, NULL ,'일반', B.CODE_NAME) AS NAME
				              , DECODE(B.CODE_NAME, NULL ,'일반', B.CODE_NAME) AS CDNAME
				              , COUNT(*) POOL_CNT
				           FROM USER01TB  A LEFT OUTER JOIN K99_CODE_DTL B ON B.MST_CODE='INSPECTOR_POOL' AND  B.DTL_CODE=A.INSPECTOR_POOL
				          WHERE 1=1 
				            AND (DCO_YN ='Y' OR BCO_YN='Y' OR INSPECTOR_POOL IS NOT NULL) 
				            AND ( AUTH_ID NOT IN('TEST2','TEST3','ubi1','ZZZ','77777','1234') OR AUTH_ID NOT LIKE 'E%')
				          GROUP BY INSPECTOR_POOL,DECODE(B.CODE_NAME, NULL ,'일반', B.CODE_NAME)
				          ORDER BY NVL(INSPECTOR_POOL,0)
		               )
	       )
     PIVOT ( SUM(POOL_CNT) AS POOL_CNT , MAX(CDNAME) AS CODENM  FOR  NAME IN( '일반' AS INX1, 'RTP' AS INX2 , '선임' AS INX3 , 'RTP/선임' AS INX4) )

    
    ]]>
    </select>
    
    <select id="selectDcoInspectCount" parameterType="HashMap" resultType="HashMap">
    <![CDATA[
    /* k01.main.inspector.selectDcoInspectCount - DCO 실적 현황 조회 ) */
    SELECT A.USER_ID
     , A.USER_NAME
     , NVL(B.ALL_CNT,0) AS ALL_CNT
     , NVL(B.BCO_YN_CNT,0) AS BCO_YN_CNT
     , NVL(B.DCO_YN_CNT,0) AS DCO_YN_CNT
     , NVL(B.DCOBCO_YN_CNT,0) AS DCOBCO_YN_CNT
     , NVL(B.CHAPERON_YN_CNT,0) AS CHAPERON_YN_CNT
     , NVL(B.PREDECESSOR_YN_CNT,0) AS PREDECESSOR_YN_CNT
     , RANK() OVER (ORDER BY NVL(B.ALL_CNT,0) DESC)  RANK_CHART
  FROM (SELECT USER_ID,USER_NAME
  FROM USER01TB  A
WHERE 1=1 
AND (DCO_YN ='Y' OR BCO_YN='Y' OR INSPECTOR_POOL IS NOT NULL) 
AND ( AUTH_ID NOT IN('TEST2','TEST3','ubi1','ZZZ','77777','1234','2045') AND AUTH_ID NOT LIKE 'E%')) A 
LEFT OUTER JOIN (
          SELECT B.USER_ID 
     , COUNT(*) ALL_CNT  
     , SUM(CASE WHEN CHOOSE_BCO_YN ='Y' THEN 1 ELSE 0 END ) AS BCO_YN_CNT
     , SUM(CASE WHEN CHOOSE_DCO_YN ='Y' THEN 1 ELSE 0 END ) AS DCO_YN_CNT
     , SUM(CASE WHEN CHOOSE_DCOBCO_YN ='Y' THEN 1 ELSE 0 END ) AS DCOBCO_YN_CNT
     , SUM(CASE WHEN CHOOSE_CHAPERON_YN ='Y' THEN 1 ELSE 0 END ) AS CHAPERON_YN_CNT
     , SUM(CASE WHEN PREDECESSOR_YN ='Y' THEN 1 ELSE 0 END ) AS PREDECESSOR_YN_CNT      
  FROM IPNT01TB A 
  JOIN IPNT07TB B 
    ON B.IPNT_UPPER_SEQ=A.IPNT_UPPER_SEQ
 WHERE 1=1
   AND 'Y' IN( CHOOSE_BCO_YN , CHOOSE_DCO_YN, PREDECESSOR_YN, CHOOSE_CHAPERON_YN, CHOOSE_DCOBCO_YN  )
   AND A.IPNT_DATE BETWEEN #{YEAR}||'0101' AND #{YEAR}||'1231'   --검사일기준
GROUP BY B.USER_ID 
  ) B ON B.USER_ID=A.USER_ID
   ORDER BY A.USER_NAME,NVL(B.ALL_CNT,0) DESC
    ]]>
    </select>
    
    <select id="selectDcDateGayongInWoon" parameterType="HashMap" resultType="HashMap">
    <![CDATA[
    /* k01.main.inspector.selectDcDateGayongInWoon - DCO 일자별 가용 인원 조회 ) */
    SELECT A.EXAM_DT AS DAY
     , TO_CHAR( A.EXAM_DATE, 'DAY') AS YOIL
     , NVL(B.LOCATION_NM,'-') AS LOCATION_NM
     , NVL(B.MAN_CNT,0) AS MAN_CNT
     , NVL(B.MAN_DCO_CNT,0) AS MAN_DCO_CNT
     , NVL(B.MAN_BCO_CNT,0) AS MAN_BCO_CNT
     , NVL(B.WOM_CNT,0) AS WOM_CNT
     , NVL(B.WOM_DCO_CNT,0) AS WOM_DCO_CNT
     , NVL(B.WOM_BCO_CNT,0) AS WOM_BCO_CNT
FROM
(
        SELECT
            TO_CHAR(TO_DATE(REPLACE(#{SEL_DT},'-',''), 'YYYYMMDD') + (ROWNUM - 1),'YYYYMMDD') AS EXAM_DT
            ,TO_DATE(REPLACE(#{SEL_DT},'-',''), 'YYYYMMDD') + (ROWNUM - 1) AS EXAM_DATE
        FROM
            DICTIONARY
        WHERE
            ROWNUM < 8
    ) A
    LEFT OUTER JOIN (   SELECT START_DT AS DAY 
						     , TO_CHAR( TO_DATE(START_DT, 'YYYYMMDD'), 'DAY') YOIL
						     , LOCATION_NM 
						     , SUM(CASE WHEN USER_SEX='M' THEN 1 ELSE 0 END)  MAN_CNT 
						     , SUM(CASE WHEN USER_SEX='M' AND DCO_YN='Y' THEN 1 ELSE 0 END)  MAN_DCO_CNT 
						     , SUM(CASE WHEN USER_SEX='M' AND BCO_YN='Y' THEN 1 ELSE 0 END)  MAN_BCO_CNT 
						     , SUM(CASE WHEN USER_SEX='F' THEN 1 ELSE 0 END)  WOM_CNT 
						     , SUM(CASE WHEN USER_SEX='F' AND DCO_YN='Y' THEN 1 ELSE 0 END)  WOM_DCO_CNT 
						     , SUM(CASE WHEN USER_SEX='F' AND BCO_YN='Y' THEN 1 ELSE 0 END)  WOM_BCO_CNT 
						FROM (SELECT SUBSTR(A.START_DT,1,8) AS START_DT
						     , B.user_sex
						     , TRIM(SUBSTR(B.user_address1, 1, INSTR( B.user_address1,' ',1,1))) AS LOCATION_NM
						     , B.DCO_YN
						     , B.BCO_YN
						  FROM K03_INSPECTOR_SCHEDULE A
						  JOIN USER01TB B 
						    ON B.USER_ID=A.USER_ID
						   AND (B.DCO_YN ='Y' OR B.BCO_YN='Y' OR B.INSPECTOR_POOL IS NOT NULL) 
						   AND ( B.AUTH_ID NOT IN('TEST2','TEST3','ubi1','ZZZ','77777','1234') OR B.AUTH_ID NOT LIKE 'E%')
						   AND A.INSP_POSSIBLE_YN='Y' 
						   AND SUBSTR(A.START_DT,1,8) BETWEEN TO_CHAR(trunc(to_date(REPLACE(#{SEL_DT},'-',''),'yyyymmdd'),'iw'),'YYYYMMDD') AND TO_CHAR(trunc(to_date(REPLACE(#{SEL_DT},'-',''),'yyyymmdd'),'iw')+6 ,'YYYYMMDD')
						 )  
						 GROUP BY START_DT
						     , LOCATION_NM ) B
             ON B.DAY=A.EXAM_DT
    ]]>
    </select>
    
</mapper>
 